
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Example: cobahh &#8212; brian2cuda 1.0.0 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Example: cuba" href="cuba.html" />
    <link rel="prev" title="Example: brunelhakim" href="brunelhakim.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="example-cobahh">
<h1>Example: cobahh<a class="headerlink" href="#example-cobahh" title="Permalink to this headline">Â¶</a></h1>
<p>This is an implementation of a benchmark described
in the following review paper:</p>
<p>Simulation of networks of spiking neurons: A review of tools and strategies (2006).
Brette, Rudolph, Carnevale, Hines, Beeman, Bower, Diesmann, Goodman, Harris, Zirpe,
Natschlaeger, Pecevski, Ermentrout, Djurfeldt, Lansner, Rochel, Vibert, Alvarez, Muller,
Davison, El Boustani and Destexhe.
Journal of Computational Neuroscience</p>
<p>Benchmark 3: random network of HH neurons with exponential synaptic conductances</p>
<p>Clock-driven implementation
(no spike time interpolation)</p>
<ol class="upperalpha simple" start="18">
<li>Brette - Dec 2007</li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">###############################################################################</span>
<span class="c1">## PARAMETERS</span>

<span class="c1"># select code generation standalone device</span>
<span class="n">devicename</span> <span class="o">=</span> <span class="s1">&#39;cuda_standalone&#39;</span>
<span class="c1">#devicename = &#39;cpp_standalone&#39;</span>

<span class="c1">#------------------------------------------------------------------------------</span>
<span class="c1"># choose mode</span>

<span class="c1"># coupling with 2% probability, nonzero coupling strength</span>
<span class="n">scenario</span> <span class="o">=</span> <span class="s1">&#39;brian2-example&#39;</span>

<span class="c1"># no coupling at all</span>
<span class="c1">#scenario = &#39;uncoupled&#39;</span>

<span class="c1"># coupling with 1000 synapses per neuron on avg, effectively zero coupling strength</span>
<span class="c1">#scenario = &#39;pseudocoupled-1000&#39;</span>

<span class="c1"># coupling with 80 synapses per neuron on avg, effectively zero coupling strength</span>
<span class="c1">#scenario = &#39;pseudocoupled-80&#39;</span>
<span class="c1">#------------------------------------------------------------------------------</span>

<span class="c1"># number of neurons</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">4000</span>

<span class="c1"># whether to profile run</span>
<span class="n">profiling</span> <span class="o">=</span> <span class="kc">True</span>

<span class="c1"># folder to store plots and profiling information</span>
<span class="n">resultsfolder</span> <span class="o">=</span> <span class="s1">&#39;results&#39;</span>

<span class="c1"># folder for the code</span>
<span class="n">codefolder</span> <span class="o">=</span> <span class="s1">&#39;code&#39;</span>

<span class="c1"># monitors (neede for plot generation)</span>
<span class="n">monitors</span> <span class="o">=</span> <span class="kc">True</span>

<span class="c1"># single precision</span>
<span class="n">single_precision</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># number of post blocks (None is default)</span>
<span class="n">num_blocks</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1"># atomic operations</span>
<span class="n">atomics</span> <span class="o">=</span> <span class="kc">True</span>

<span class="c1"># push synapse bundles</span>
<span class="n">bundle_mode</span> <span class="o">=</span> <span class="kc">True</span>

<span class="c1">###############################################################################</span>
<span class="c1">## CONFIGURATION</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;devicename&#39;</span><span class="p">:</span> <span class="n">devicename</span><span class="p">,</span>
          <span class="s1">&#39;scenario&#39;</span><span class="p">:</span> <span class="n">scenario</span><span class="p">,</span>
          <span class="s1">&#39;resultsfolder&#39;</span><span class="p">:</span> <span class="n">resultsfolder</span><span class="p">,</span>
          <span class="s1">&#39;codefolder&#39;</span><span class="p">:</span> <span class="n">codefolder</span><span class="p">,</span>
          <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="n">N</span><span class="p">,</span>
          <span class="s1">&#39;profiling&#39;</span><span class="p">:</span> <span class="n">profiling</span><span class="p">,</span>
          <span class="s1">&#39;monitors&#39;</span><span class="p">:</span> <span class="n">monitors</span><span class="p">,</span>
          <span class="s1">&#39;single_precision&#39;</span><span class="p">:</span> <span class="n">single_precision</span><span class="p">,</span>
          <span class="s1">&#39;num_blocks&#39;</span><span class="p">:</span> <span class="n">num_blocks</span><span class="p">,</span>
          <span class="s1">&#39;atomics&#39;</span><span class="p">:</span> <span class="n">atomics</span><span class="p">,</span>
          <span class="s1">&#39;bundle_mode&#39;</span><span class="p">:</span> <span class="n">bundle_mode</span><span class="p">}</span>

<span class="c1"># Add parameter restrictions</span>
<span class="n">choices</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;devicename&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;cuda_standalone&#39;</span><span class="p">,</span> <span class="s1">&#39;cpp_standalone&#39;</span><span class="p">,</span> <span class="s1">&#39;genn&#39;</span><span class="p">],</span>
           <span class="s1">&#39;scenario&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;brian2-example&#39;</span><span class="p">,</span> <span class="s1">&#39;uncoupled&#39;</span><span class="p">,</span> <span class="s1">&#39;pseudocoupled-80&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;pseudocoupled-1000&#39;</span><span class="p">]}</span>

<span class="kn">from</span> <span class="nn">utils</span> <span class="k">import</span> <span class="n">set_prefs</span><span class="p">,</span> <span class="n">update_from_command_line</span>

<span class="c1"># update params from command line</span>
<span class="n">update_from_command_line</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="n">choices</span><span class="p">)</span>

<span class="c1"># do the imports after parsing command line arguments (quicker --help)</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;Agg&#39;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">brian2</span> <span class="k">import</span> <span class="o">*</span>
<span class="k">if</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;devicename&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;cuda_standalone&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">brian2cuda</span>
<span class="k">if</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;devicename&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;genn&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">brian2genn</span>
    <span class="k">if</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;profiling&#39;</span><span class="p">]:</span>
        <span class="n">prefs</span><span class="p">[</span><span class="s1">&#39;devices.genn.kernel_timing&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">params</span><span class="p">[</span><span class="s1">&#39;profiling&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># set brian2 prefs from params dict</span>
<span class="n">name</span> <span class="o">=</span> <span class="n">set_prefs</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">prefs</span><span class="p">)</span>

<span class="n">codefolder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;codefolder&#39;</span><span class="p">],</span> <span class="n">name</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;runing example </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;compiling model in </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">codefolder</span><span class="p">))</span>

<span class="c1">###############################################################################</span>
<span class="c1">## SIMULATION</span>

<span class="n">set_device</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;devicename&#39;</span><span class="p">],</span> <span class="n">directory</span><span class="o">=</span><span class="n">codefolder</span><span class="p">,</span> <span class="nb">compile</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">run</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
           <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Parameters</span>
<span class="n">area</span> <span class="o">=</span> <span class="mi">20000</span><span class="o">*</span><span class="n">umetre</span><span class="o">**</span><span class="mi">2</span>
<span class="n">Cm</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="n">ufarad</span><span class="o">*</span><span class="n">cm</span><span class="o">**-</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">area</span>
<span class="n">gl</span> <span class="o">=</span> <span class="p">(</span><span class="mf">5e-5</span><span class="o">*</span><span class="n">siemens</span><span class="o">*</span><span class="n">cm</span><span class="o">**-</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">area</span>

<span class="n">El</span> <span class="o">=</span> <span class="o">-</span><span class="mi">60</span><span class="o">*</span><span class="n">mV</span>
<span class="n">EK</span> <span class="o">=</span> <span class="o">-</span><span class="mi">90</span><span class="o">*</span><span class="n">mV</span>
<span class="n">ENa</span> <span class="o">=</span> <span class="mi">50</span><span class="o">*</span><span class="n">mV</span>
<span class="n">g_na</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">msiemens</span><span class="o">*</span><span class="n">cm</span><span class="o">**-</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">area</span>
<span class="n">g_kd</span> <span class="o">=</span> <span class="p">(</span><span class="mi">30</span><span class="o">*</span><span class="n">msiemens</span><span class="o">*</span><span class="n">cm</span><span class="o">**-</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">area</span>
<span class="n">VT</span> <span class="o">=</span> <span class="o">-</span><span class="mi">63</span><span class="o">*</span><span class="n">mV</span>
<span class="c1"># Time constants</span>
<span class="n">taue</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">ms</span>
<span class="n">taui</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">ms</span>
<span class="c1"># Reversal potentials</span>
<span class="n">Ee</span> <span class="o">=</span> <span class="mi">0</span><span class="o">*</span><span class="n">mV</span>
<span class="n">Ei</span> <span class="o">=</span> <span class="o">-</span><span class="mi">80</span><span class="o">*</span><span class="n">mV</span>

<span class="c1"># The model</span>
<span class="n">eqs</span> <span class="o">=</span> <span class="n">Equations</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">dv/dt = (gl*(El-v)+ge*(Ee-v)+gi*(Ei-v)-</span>
<span class="s1">         g_na*(m*m*m)*h*(v-ENa)-</span>
<span class="s1">         g_kd*(n*n*n*n)*(v-EK))/Cm : volt</span>
<span class="s1">dm/dt = alpha_m*(1-m)-beta_m*m : 1</span>
<span class="s1">dn/dt = alpha_n*(1-n)-beta_n*n : 1</span>
<span class="s1">dh/dt = alpha_h*(1-h)-beta_h*h : 1</span>
<span class="s1">dge/dt = -ge*(1./taue) : siemens</span>
<span class="s1">dgi/dt = -gi*(1./taui) : siemens</span>
<span class="s1">alpha_m = 0.32*(mV**-1)*(13*mV-v+VT)/</span>
<span class="s1">         (exp((13*mV-v+VT)/(4*mV))-1.)/ms : Hz</span>
<span class="s1">beta_m = 0.28*(mV**-1)*(v-VT-40*mV)/</span>
<span class="s1">        (exp((v-VT-40*mV)/(5*mV))-1)/ms : Hz</span>
<span class="s1">alpha_h = 0.128*exp((17*mV-v+VT)/(18*mV))/ms : Hz</span>
<span class="s1">beta_h = 4./(1+exp((40*mV-v+VT)/(5*mV)))/ms : Hz</span>
<span class="s1">alpha_n = 0.032*(mV**-1)*(15*mV-v+VT)/</span>
<span class="s1">         (exp((15*mV-v+VT)/(5*mV))-1.)/ms : Hz</span>
<span class="s1">beta_n = .5*exp((10*mV-v+VT)/(40*mV))/ms : Hz</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>

<span class="n">P</span> <span class="o">=</span> <span class="n">NeuronGroup</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">],</span> <span class="n">model</span><span class="o">=</span><span class="n">eqs</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="s1">&#39;v&gt;-20*mV&#39;</span><span class="p">,</span> <span class="n">refractory</span><span class="o">=</span><span class="mi">3</span><span class="o">*</span><span class="n">ms</span><span class="p">,</span>
                <span class="n">method</span><span class="o">=</span><span class="s1">&#39;exponential_euler&#39;</span><span class="p">)</span>

<span class="c1"># only synapses for the other scenarios</span>
<span class="k">if</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;scenario&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;uncoupled&#39;</span><span class="p">:</span>
    <span class="n">Ne</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.8</span> <span class="o">*</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">])</span>
    <span class="n">Pe</span> <span class="o">=</span> <span class="n">P</span><span class="p">[:</span><span class="n">Ne</span><span class="p">]</span>
    <span class="n">Pi</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="n">Ne</span><span class="p">:]</span>
    <span class="n">Ce</span> <span class="o">=</span> <span class="n">Synapses</span><span class="p">(</span><span class="n">Pe</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="s1">&#39;we : siemens (constant)&#39;</span><span class="p">,</span> <span class="n">on_pre</span><span class="o">=</span><span class="s1">&#39;ge+=we&#39;</span><span class="p">)</span>
    <span class="n">Ci</span> <span class="o">=</span> <span class="n">Synapses</span><span class="p">(</span><span class="n">Pi</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="s1">&#39;wi : siemens (constant)&#39;</span><span class="p">,</span> <span class="n">on_pre</span><span class="o">=</span><span class="s1">&#39;gi+=wi&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;scenario&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;brian2-example&#39;</span><span class="p">:</span>
        <span class="c1"># 0.02*N syn per neuron with nonzero efficacy</span>
        <span class="n">Ce</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span>
        <span class="n">Ci</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;scenario&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;pseudocoupled-1000&#39;</span><span class="p">:</span>
        <span class="c1"># fixed avg no of 1000 syn per neuron with effectively zero efficacy</span>
        <span class="n">Ce</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">1000.</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">P</span><span class="p">))</span>
        <span class="n">Ci</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">1000.</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">P</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;scenario&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;pseudocoupled-80&#39;</span><span class="p">:</span>
        <span class="c1"># fixed avg no of 80 syn per neuron with effectively zero efficacy</span>
        <span class="n">Ce</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">80.</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">P</span><span class="p">))</span>
        <span class="n">Ci</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">80.</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">P</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;scenario&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;brian2-example&#39;</span><span class="p">:</span>
        <span class="c1"># nonzero efficacy</span>
        <span class="n">Ce</span><span class="o">.</span><span class="n">we</span> <span class="o">=</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">nS</span>
        <span class="n">Ci</span><span class="o">.</span><span class="n">wi</span> <span class="o">=</span> <span class="mi">67</span> <span class="o">*</span> <span class="n">nS</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># effectively zero efficacy</span>
        <span class="c1"># (but avoiding compilier optimisations of constants in generated code)</span>
        <span class="n">Ce</span><span class="o">.</span><span class="n">we</span> <span class="o">=</span> <span class="s1">&#39;rand() * 1e-9*nS&#39;</span>
        <span class="n">Ci</span><span class="o">.</span><span class="n">wi</span> <span class="o">=</span> <span class="s1">&#39;rand() * 1e-9*nS&#39;</span>

<span class="c1"># Initialization</span>
<span class="n">P</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="s1">&#39;El + (randn() * 5 - 5)*mV&#39;</span>
<span class="n">P</span><span class="o">.</span><span class="n">ge</span> <span class="o">=</span> <span class="s1">&#39;(randn() * 1.5 + 4) * 10.*nS&#39;</span>
<span class="n">P</span><span class="o">.</span><span class="n">gi</span> <span class="o">=</span> <span class="s1">&#39;(randn() * 12 + 20) * 10.*nS&#39;</span>

<span class="k">if</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;monitors&#39;</span><span class="p">]:</span>
    <span class="n">trace</span> <span class="o">=</span> <span class="n">StateMonitor</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">record</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">P</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="n">P</span><span class="o">.</span><span class="n">N</span> <span class="o">//</span> <span class="mi">100</span><span class="p">))</span>
    <span class="n">spikemon</span> <span class="o">=</span> <span class="n">SpikeMonitor</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
    <span class="n">popratemon</span> <span class="o">=</span> <span class="n">PopulationRateMonitor</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>

<span class="n">run</span><span class="p">(</span><span class="mi">1</span> <span class="o">*</span> <span class="n">second</span><span class="p">,</span> <span class="n">report</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">profile</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;profiling&#39;</span><span class="p">])</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;resultsfolder&#39;</span><span class="p">]):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;resultsfolder&#39;</span><span class="p">])</span> <span class="c1"># for plots and profiling txt file</span>
<span class="k">if</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;profiling&#39;</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">profiling_summary</span><span class="p">())</span>
    <span class="n">profilingpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;resultsfolder&#39;</span><span class="p">],</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.txt&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">profilingpath</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">profiling_file</span><span class="p">:</span>
        <span class="n">profiling_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">profiling_summary</span><span class="p">()))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;profiling information saved in </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">profilingpath</span><span class="p">))</span>

<span class="k">if</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;monitors&#39;</span><span class="p">]:</span>
    <span class="n">subplot</span><span class="p">(</span><span class="mi">311</span><span class="p">)</span>
    <span class="n">plot</span><span class="p">(</span><span class="n">spikemon</span><span class="o">.</span><span class="n">t</span><span class="o">/</span><span class="n">ms</span><span class="p">,</span> <span class="n">spikemon</span><span class="o">.</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;,k&#39;</span><span class="p">)</span>
    <span class="n">subplot</span><span class="p">(</span><span class="mi">312</span><span class="p">)</span>
    <span class="n">plot</span><span class="p">(</span><span class="n">trace</span><span class="o">.</span><span class="n">t</span><span class="o">/</span><span class="n">ms</span><span class="p">,</span> <span class="n">trace</span><span class="o">.</span><span class="n">v</span><span class="p">[:]</span><span class="o">.</span><span class="n">T</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">5</span><span class="p">])</span>
    <span class="n">subplot</span><span class="p">(</span><span class="mi">313</span><span class="p">)</span>
    <span class="n">plot</span><span class="p">(</span><span class="n">popratemon</span><span class="o">.</span><span class="n">t</span><span class="o">/</span><span class="n">ms</span><span class="p">,</span> <span class="n">popratemon</span><span class="o">.</span><span class="n">smooth_rate</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="o">*</span><span class="n">ms</span><span class="p">))</span>
    <span class="c1">#show()</span>

    <span class="n">plotpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;resultsfolder&#39;</span><span class="p">],</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
    <span class="n">savefig</span><span class="p">(</span><span class="n">plotpath</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plot saved in </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">plotpath</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the generated model in </span><span class="si">{}</span><span class="s1"> needs to removed manually if wanted&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">codefolder</span><span class="p">))</span>
</pre></div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">brian2cuda</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">Introduction</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../reference/brian2cuda.html">Reference documentation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Example documentation</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Examples</a><ul>
      <li>Previous: <a href="brunelhakim.html" title="previous chapter">Example: brunelhakim</a></li>
      <li>Next: <a href="cuba.html" title="next chapter">Example: cuba</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021-, Brian2Cuda authors.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/examples/cobahh.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>